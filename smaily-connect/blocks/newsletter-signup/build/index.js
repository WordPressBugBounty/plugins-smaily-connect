(()=>{"use strict";var e,t={816:(e,t,n)=>{const l=window.React,a=window.wp.blocks,o=window.wp.i18n,s=window.wp.apiFetch;var r=n.n(s);const c=window.wp.blockEditor,i=window.wp.element,u=window.wp.components;function m(e){return"string"!=typeof e||""===e?null:e.startsWith("var:preset|")?`var(${e.replace("var:preset|","--wp--preset--").replace("|","--")})`:e}function b({hiddenFields:e,onChange:t}){const n=(n,l,a)=>{const o=[...e];o[n]={...o[n],[l]:a},t(o)};return(0,l.createElement)(u.BaseControl,{id:"smaily-connect-newsletter-signup-custom-hidden-fields",label:(0,o.__)("Custom fields","smaily-connect")},e.length>0&&(0,l.createElement)("div",{style:{marginBottom:"16px"}},e.map(((a,s)=>(0,l.createElement)("div",{key:s,style:{display:"flex",gap:"8px",marginBottom:"8px"}},(0,l.createElement)(u.TextControl,{label:(0,o.__)("Name","smaily-connect"),value:a.name,onChange:e=>n(s,"name",e),style:{flex:1,marginBottom:0}}),(0,l.createElement)(u.TextControl,{label:(0,o.__)("Value","smaily-connect"),value:a.value,onChange:e=>n(s,"value",e),style:{flex:1,marginBottom:0}}),(0,l.createElement)(u.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(n=>{const l=e.filter(((e,t)=>t!==n));t(l)})(s),style:{alignSelf:"center"}},(0,o.__)("Remove","smaily-connect")))))),(0,l.createElement)(u.Button,{variant:"secondary",onClick:()=>{t([...e,{name:"",value:""}])}},(0,o.__)("Add field","smaily-connect")))}const d=JSON.parse('{"UU":"smaily/newsletter-block"}'),p=(0,l.createElement)("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",xmlns:"http://www.w3.org/2000/svg"},(0,l.createElement)("path",{d:"M39.9967 48H8.00318C3.58037 48 0 44.4019 0 39.9809V8C0 3.57895 3.58037 0 8.00318 0H39.9967C44.4196 0 47.9999 3.57895 47.9999 8V39.9809C48.0191 44.4019 44.4196 48 39.9967 48Z",fill:"#E91E63"}),(0,l.createElement)("path",{d:"M26.9025 43.5791C26.2898 43.9427 25.6006 44.2106 24.8347 44.3829C24.0689 44.5551 23.3221 44.6508 22.5754 44.6508C21.0437 44.6508 19.5695 44.3063 18.1335 43.5982C17.2528 43.1771 16.4678 42.6413 15.7785 41.9905C14.8978 45.4355 11.7769 47.9618 8.0625 47.981H35.2312C35.8439 47.2346 36.38 46.3925 36.8203 45.4929C37.6819 43.7322 38.1223 41.6652 38.1223 39.3111C38.1223 36.8231 37.6436 34.8518 36.7055 33.359C35.7673 31.8853 34.5802 30.6987 33.1442 29.8183C31.7083 28.9379 30.1765 28.2489 28.53 27.7704C26.8834 27.292 25.3325 26.8135 23.9157 26.335C22.4797 25.8566 21.2926 25.2824 20.3545 24.5934C19.4163 23.9044 18.9376 22.9283 18.9376 21.646C18.9376 20.8422 19.1291 20.1724 19.5312 19.5982C19.9141 19.0432 20.431 18.5838 21.0629 18.2393C21.6947 17.8948 22.3648 17.646 23.0732 17.4929C30.1574 16.1915 31.8423 21.9523 31.8423 21.9523L38.084 13.0527C37.5479 12.5743 37.0118 12.1341 36.4374 11.7513L36.4183 11.7322C35.0972 10.8135 33.6612 10.1054 32.1295 9.6269C29.9276 8.93791 27.6492 8.61255 25.2942 8.61255C23.2456 8.61255 21.2735 8.89963 19.3397 9.47379C17.4251 10.048 15.721 10.9283 14.2468 12.0767C12.7725 13.2441 11.6046 14.6795 10.7047 16.402C9.82397 18.1245 9.3836 20.1341 9.3836 22.4116C9.3836 24.7657 9.86226 26.6795 10.8196 28.1149C11.7769 29.5503 12.9831 30.7178 14.4382 31.5982C15.8934 32.4786 17.4634 33.1867 19.1482 33.7035C20.8331 34.2202 22.4031 34.7369 23.8582 35.2728C25.3134 35.7896 26.5196 36.4212 27.4769 37.1676C28.4342 37.914 28.9129 38.9283 28.9129 40.1915C28.9129 40.957 28.7214 41.6078 28.3576 42.1819C28.013 42.7561 27.5152 43.2154 26.9025 43.5791Z",fill:"white"}));(0,a.registerBlockType)(d.UU,{edit:function({attributes:e,setAttributes:t}){const[n,a]=(0,i.useState)(null),s=(0,i.useRef)(),d=(0,c.useBlockProps)({className:"wp-block-smaily-newsletter-block-wrapper",style:{"--smaily-subscribe-button-bg-color":e.subscribeButtonBackgroundColor,"--smaily-subscribe-button-text-color":e.subscribeButtonTextColor,"--smaily-subscribe-button-width":e.subscribeButtonWidth,"--smaily-subscribe-button-border-radius":`${e.subscribeButtonBorderRadius}px`}});(0,i.useEffect)((()=>{if(e.style?.elements?.button?.color?.background){const n=m(e.style.elements.button.color.background);t({subscribeButtonBackgroundColor:n})}else t({subscribeButtonBackgroundColor:"var(--wp-admin-theme-color, #007cba)"})}),[e.style?.elements?.button?.color?.background,t]),(0,i.useEffect)((()=>{if(e.style?.elements?.button?.color?.text){const n=m(e.style.elements.button.color.text);t({subscribeButtonTextColor:n})}else t({subscribeButtonTextColor:"var(--wp-components-color-accent-inverted, #ffffff)"})}),[e.style?.elements?.button?.color?.text,t]);const{subdomain:p,autoresponderId:y,emailInputLabel:C,errorMessage:g,errorURL:_,nameInputLabel:h,showNameField:f,subscribeButtonLabel:v,subscribeButtonWidth:w,successMessage:E,successURL:B}=e;(0,i.useEffect)((()=>{(async()=>{const[e,n]=await Promise.all([r()({path:"/smaily/v1/autoresponders"}),r()({path:"/smaily/v1/configuration"})]);a(e),t({subdomain:n.subdomain}),s.current=n.settings_url})()}),[t]);return null===n?(0,l.createElement)(u.Spinner,null):""===p?(0,l.createElement)(u.Notice,{status:"error",isDismissible:!1,actions:[{label:(0,o.__)("Go to plugin settings","smaily-connect"),onClick:async()=>{s.current&&(window.location.href=s.current)},variant:"primary"}]},(0,l.createElement)("h3",null,(0,o.__)("Plugin setup is not complete!","smaily-connect")),(0,l.createElement)("p",null,(0,o.__)("Please connect your Smaily account before adding a form!","smaily-connect"))):(0,l.createElement)(l.Fragment,null,(0,l.createElement)("div",{...d},(0,l.createElement)("div",{className:"smaily-newsletter-block-notice-container",style:{flexDirection:"column",alignItems:"inherit"}},""!==E&&(0,l.createElement)(u.Notice,{status:"success",isDismissible:!1},E),""!==g&&(0,l.createElement)(u.Notice,{status:"error",isDismissible:!1},g)),(0,l.createElement)("div",null,(0,l.createElement)("form",null,f&&(0,l.createElement)(u.TextControl,{type:"text",name:"name",label:""!==h&&h,value:""}),(0,l.createElement)(u.TextControl,{type:"email",name:"email",label:""!==C&&C,value:"",required:!0}),(0,l.createElement)(u.Button,{className:"smaily-newsletter-block-button-submit",variant:"primary",type:"submit"},v)))),(0,l.createElement)(c.InspectorControls,null,(0,l.createElement)(u.PanelBody,{title:(0,o.__)("Visible fields","smaily-connect")},(0,l.createElement)(u.ToggleControl,{label:(0,o.__)("Display name field","smaily-connect"),checked:f,onChange:()=>t({showNameField:!f}),name:"show_name"}),f&&(0,l.createElement)(u.TextControl,{label:(0,o.__)("Name field label","smaily-connect"),value:h,name:"nameInputLabel",onChange:e=>t({nameInputLabel:e})}),(0,l.createElement)(u.TextControl,{label:(0,o.__)("Email field label","smaily-connect"),value:C,name:"emailInputLabel",onChange:e=>t({emailInputLabel:e})}),(0,l.createElement)(u.TextControl,{label:(0,o.__)("Subscribe button label","smaily-connect"),value:v,name:"subscribeButtonLabel",onChange:e=>t({subscribeButtonLabel:e})}),(0,l.createElement)(u.ToggleControl,{label:(0,o.__)("Full width subscribe button","smaily-connect"),checked:"100%"===w,onChange:e=>t({subscribeButtonWidth:e?"100%":"auto"}),name:"show_name"}),(0,l.createElement)(u.RangeControl,{label:(0,o.__)("Button border radius","smaily-connect"),value:e.subscribeButtonBorderRadius,onChange:e=>{t({subscribeButtonBorderRadius:e})},min:0}),(0,l.createElement)(u.TextControl,{label:(0,o.__)("Success message","smaily-connect"),value:E,name:"successMessage",onChange:e=>t({successMessage:e})}),(0,l.createElement)(u.TextControl,{label:(0,o.__)("Error message","smaily-connect"),value:g,name:"errorMessage",onChange:e=>t({errorMessage:e})})),(0,l.createElement)(u.PanelBody,{title:(0,o.__)("Hidden fields","smaily-connect"),initialOpen:!1},(0,l.createElement)(u.TextControl,{label:(0,o.__)("Success URL","smaily-connect"),value:B,name:"successURL",onChange:e=>t({successURL:e}),help:(0,o.__)("Defaults to current page URL.","smaily-connect")}),(0,l.createElement)(u.TextControl,{label:(0,o.__)("Failure URL","smaily-connect"),value:_,name:"failure_url",onChange:e=>t({errorURL:e}),help:(0,o.__)("Defaults to current page URL.","smaily-connect")}),(0,l.createElement)(u.SelectControl,{label:(0,o.__)("Autoresponder","smaily-connect"),name:"autoresponderId",value:y,onChange:e=>t({autoresponderId:e}),options:[{label:(0,o.__)("No autoresponder","smaily-connect"),value:""},...n]}),(0,l.createElement)(b,{hiddenFields:e.hiddenFields||[],onChange:e=>t({hiddenFields:e})}))))},icon:p,title:(0,o.__)("Smaily Opt-In Form","smaily-connect"),description:(0,o.__)("Opt-in subscribers directly to Smaily for seamless email marketing.","smaily-connect"),keywords:[(0,o.__)("email","smaily-connect"),(0,o.__)("newsletter","smaily-connect"),"smaily"]})}},n={};function l(e){var a=n[e];if(void 0!==a)return a.exports;var o=n[e]={exports:{}};return t[e](o,o.exports,l),o.exports}l.m=t,e=[],l.O=(t,n,a,o)=>{if(!n){var s=1/0;for(u=0;u<e.length;u++){for(var[n,a,o]=e[u],r=!0,c=0;c<n.length;c++)(!1&o||s>=o)&&Object.keys(l.O).every((e=>l.O[e](n[c])))?n.splice(c--,1):(r=!1,o<s&&(s=o));if(r){e.splice(u--,1);var i=a();void 0!==i&&(t=i)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,a,o]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={57:0,350:0};l.O.j=t=>0===e[t];var t=(t,n)=>{var a,o,[s,r,c]=n,i=0;if(s.some((t=>0!==e[t]))){for(a in r)l.o(r,a)&&(l.m[a]=r[a]);if(c)var u=c(l)}for(t&&t(n);i<s.length;i++)o=s[i],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return l.O(u)},n=globalThis.webpackChunksmaily_newsletter_block=globalThis.webpackChunksmaily_newsletter_block||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var a=l.O(void 0,[350],(()=>l(816)));a=l.O(a)})();